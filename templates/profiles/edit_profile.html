{% extends 'base_generic.html' %}
{% load static %}

{% block content %}
<style>
input[type="file"] {
    display: none;
}
.custom-file-upload {
    border: 1px solid #ccc;
    display: inline-block;
    padding: 6px 12px;
    cursor: pointer;
}
#birth_date {
  display: flex;
  flex-direction: row;
  align-items: center;
}
.ui-datepicker-trigger {
  border: 1px solid #ccc;
  display: inline-block;
  padding: 6px 12px;
  cursor: pointer;
  height: 40px;
}

</style>
<div class="main showcase">
  <h1>Edit Profile</h1>
  <form id="form" method="POST" enctype="multipart/form-data">
    {% csrf_token %}
    <div id="birth_date" class="form-group" style="width:50%">
      <label for="{{ form.date_of_birth.id_for_label }}">Data Nasterii:</label>
      {{ form.date_of_birth }}
    </div>
  </br>
    <div class="form-group">
      <label for="{{ form.current_weight.id_for_label }}">Greutate:</label>
      {{ form.current_weight }}
    </div>
  </br>
    <div class="form-group">
      <label for="{{ form.profile_image.id_for_label }}">Imagine de profil:</label>
      <label for="{{ form.profile_image.id_for_label }}" class="custom-file-upload">
        <i class="fa fa-cloud-upload"></i> Selecteaza Imaginea
      </label>
      {{ form.profile_image }}
    </div>
  </br>
    <button type="submit" class="btn btn-primary">Salveaza Datele</button>
  </form>
</div>

{% block scripts %}
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap-datepicker@1.9.0/dist/js/bootstrap-datepicker.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-datepicker@1.9.0/dist/css/bootstrap-datepicker.min.css" />
<script src="https://code.jquery.com/ui/1.13.1/jquery-ui.min.js"></script>
<link rel="stylesheet" href="https://code.jquery.com/ui/1.13.1/themes/smoothness/jquery-ui.css">
<script>
  const form = document.getElementById("{{ form.date_of_birth.id_for_label }}");
  function test() {
    const birthDate = new Date(form.value);
    const today = new Date();
    const age = today.getFullYear() - birthDate.getFullYear();
    const month = today.getMonth() - birthDate.getMonth();
    if (month < 0 || (month === 0 && today.getDate() < birthDate.getDate())) {
      age--;
    }
    if (age >= 18) {
      document.querySelector(".btn").disabled = false;
    } else {
      document.querySelector(".btn").disabled = true;
      alert("Trebuie sa fii major!")
    }
  }
  form.addEventListener("change", test);
</script>
<script type="text/javascript">
  $('#date_of_birth').datepicker({
    dateFormat: 'yy-mm-dd',
    changeMonth: true,
    changeYear: true,
    yearRange: "1950:2006",
    showOtherMonths: false,
    selectOtherMonths: false,
    showButtonPanel: true,
    showAnim: 'fadeIn',
    beforeShow: function(input, inst) {
      
      var value = $(input).val();
      
     
      if (value) {
        var dateParts = value.split('-');
        var year = parseInt(dateParts[0], 10);
        var month = parseInt(dateParts[1], 10) - 1;
        var day = parseInt(dateParts[2], 10);
        $(this).datepicker('setDate', new Date(year, month, day));
      }
      
    
      inst.dpDiv.css({
        top: 100,
        left: 100,
        
        'font-size': '16px',
        'background-color': '#fff',
        'border-color': '#999'
      });
    },
    buttonImageOnly: false,
     
      buttonText: "Selecteaza Data",
      showOn: 'button',
      duration: 200,
      theme: "ui-smoothness"
    });
    
   
  
</script>
{% endblock %}
{% endblock %}